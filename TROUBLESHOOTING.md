# 🔧 问题排查指南

## 常见问题及解决方案

---

## ❓ 问题：看不到已上传的文件

### 原因分析
如果你之前上传过文件但现在看不到，可能是因为：
1. 旧版本只保存了文件名和大小，没有保存文件数据
2. 浏览器 localStorage 数据格式不兼容
3. 文件数据已损坏或丢失

### ✅ 解决方案

#### 方案1：自动清理（推荐） ⭐
1. **刷新上传页面**
   ```
   按 F5 或 Ctrl+R 刷新页面
   ```

2. **系统会自动清理无效数据**
   - 打开浏览器控制台（F12）
   - 如果有旧数据被清理，会看到提示：`已清理旧的无效文件记录`

3. **重新上传文件**
   - 现在上传的文件会包含完整数据
   - 可以正常下载和管理

#### 方案2：手动清空全部文件
1. 访问上传页面
2. 在"已上传文件"区域点击右上角的**"清空全部"**按钮
3. 确认清空操作
4. 重新上传文件

#### 方案3：清除浏览器存储
1. 打开浏览器开发者工具（F12）
2. 进入 **Application** 或 **存储** 标签
3. 在左侧找到 **Local Storage**
4. 选择你的网站
5. 删除 `uploadedFiles` 键
6. 刷新页面
7. 重新上传文件

---

## ❓ 问题：文件上传后立即消失

### 原因
- 浏览器存储空间不足
- 文件太大超过限制
- 浏览器不支持 FileReader API

### ✅ 解决方案

1. **检查文件大小**
   - 确保单个文件 < 5MB
   - 建议图片压缩后再上传

2. **清理旧文件**
   - 点击"清空全部"按钮
   - 或删除不需要的文件

3. **更新浏览器**
   - 使用最新版 Chrome、Edge 或 Firefox

---

## ❓ 问题：无法下载文件

### 原因
- 浏览器阻止了自动下载
- 文件数据不完整

### ✅ 解决方案

1. **检查浏览器设置**
   - 允许网站自动下载文件
   - 检查下载设置

2. **查看控制台错误**
   - 按 F12 打开开发者工具
   - 查看 Console 标签中的错误信息

3. **重新上传文件**
   - 如果是旧文件，重新上传一次

---

## ❓ 问题：上传进度卡住不动

### ✅ 解决方案

1. **刷新页面**重试
2. **检查文件是否太大**（应 < 5MB）
3. **尝试上传更小的文件**测试

---

## 🛠️ 调试工具

### 查看存储的文件数据

1. 打开控制台（F12）
2. 执行以下命令：

```javascript
// 查看所有已上传文件
const files = JSON.parse(localStorage.getItem('uploadedFiles'));
console.log(files);

// 查看文件数量
console.log('文件数量:', files ? files.length : 0);

// 查看第一个文件的详细信息
if (files && files.length > 0) {
  console.log('第一个文件:', files[0]);
  console.log('是否有数据:', !!files[0].data);
}
```

### 清空所有数据

```javascript
// 清空已上传文件
localStorage.removeItem('uploadedFiles');
console.log('已清空所有数据');
location.reload();
```

### 查看存储空间使用情况

```javascript
// 计算存储空间使用
let total = 0;
for (let key in localStorage) {
  if (localStorage.hasOwnProperty(key)) {
    total += localStorage[key].length;
  }
}
console.log('存储使用:', (total / 1024 / 1024).toFixed(2), 'MB');
```

---

## 📋 问题报告清单

如果问题仍未解决，请提供以下信息：

- [ ] 浏览器名称和版本
- [ ] 操作系统
- [ ] 文件类型和大小
- [ ] 控制台错误信息（F12 → Console）
- [ ] 问题发生的具体步骤
- [ ] 截图（如果可能）

---

## 🚀 最佳实践建议

### 上传文件
✅ **推荐做法：**
- 使用小于 5MB 的文件
- 图片压缩后再上传
- 重要文件及时下载备份
- 定期清理不需要的文件

❌ **避免：**
- 上传超大文件
- 同时上传太多文件
- 长期依赖浏览器存储

### 文件管理
- 📥 上传后立即测试下载功能
- 🗑️ 定期删除不需要的文件
- 💾 重要文件保存到本地
- 🔄 定期备份重要数据

---

## 💡 快速解决流程

```
遇到问题
    ↓
1. 刷新页面（F5）
    ↓
2. 打开控制台（F12）查看错误
    ↓
3. 点击"清空全部"清理数据
    ↓
4. 重新上传测试文件
    ↓
5. 测试下载功能
    ↓
问题解决 ✓
```

---

## 📞 获取帮助

如果以上方法都无法解决问题：

1. **查看文档**
   - `FEATURES.md` - 功能说明
   - `DOWNLOAD_GUIDE.md` - 下载指南
   - `QUICK_START.md` - 快速开始

2. **检查更新**
   - 确保使用最新版本的代码

3. **提交反馈**
   - GitHub Issues
   - 详细描述问题

---

**最后更新**: 2024-10-24  
**版本**: v2.1

