<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <title>Firebaseæµ‹è¯•</title>
</head>

<body>
    <h1>Firebase Firestore æµ‹è¯•</h1>
    <div id="result"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, doc, getDoc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBspolmlmt50Skx6cq62_sqsUyYXkglBhg",
            authDomain: "my-blog-b5278.firebaseapp.com",
            projectId: "my-blog-b5278",
            storageBucket: "my-blog-b5278.firebasestorage.app",
            messagingSenderId: "1019644740604",
            appId: "1:1019644740604:web:65a21a4f159d01317d2879"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const resultDiv = document.getElementById('result');

        async function testFirestore() {
            try {
                resultDiv.innerHTML += '<p>ğŸ” æµ‹è¯•è¯»å– usernames/kuankuantj...</p>';

                // å°è¯•è¯»å–ç”¨æˆ·åæ˜ å°„
                const usernameDoc = await getDoc(doc(db, 'usernames', 'kuankuantj'));

                if (usernameDoc.exists()) {
                    const data = usernameDoc.data();
                    resultDiv.innerHTML += `<p>âœ… æ‰¾åˆ°ç”¨æˆ·åæ˜ å°„ï¼</p>`;
                    resultDiv.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    resultDiv.innerHTML += '<p>âŒ ç”¨æˆ·åæ˜ å°„ä¸å­˜åœ¨</p>';
                    resultDiv.innerHTML += '<p>ğŸ’¡ è¿™æ„å‘³ç€æ‚¨éœ€è¦é‡æ–°æ³¨å†Œæ‰èƒ½ä½¿ç”¨ç”¨æˆ·åç™»å½•</p>';
                }
            } catch (error) {
                resultDiv.innerHTML += `<p>âŒ é”™è¯¯: ${error.message}</p>`;
                resultDiv.innerHTML += `<p>é”™è¯¯ä»£ç : ${error.code}</p>`;

                if (error.code === 'permission-denied') {
                    resultDiv.innerHTML += '<p>âš ï¸ æƒé™é”™è¯¯ï¼è¯·æ£€æŸ¥Firestoreè§„åˆ™æ˜¯å¦æ­£ç¡®é…ç½®</p>';
                }
            }
        }

        testFirestore();
    </script>
</body>

</html>